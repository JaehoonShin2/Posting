
## IAM 구성

IAM 는 다음과 같은 구성으로 이루어져 있다.

- 사용자 단위 : 실제 AWS 를 사용하는 살마 혹은 어플리케이션
- 그룹 : 사용자의 집합 단위. 그룹에 속한 사용자는 그룹에 부여돈 권한을 행사하게 된다.
- 정책 : 사용자와 그룹, 역할이 무엇을 할 수 있는지에 대한 문서. JSON 형식으로 정의
- 역할 : AWS 리소스에 부여해 AWS 리소스가 무엇을 할 수 있을지 정의. 혹은 다른 사용자가 역할을 부여받아 사용하기도 하고, 다른 자격에 대해 신뢰관계를 구축 할 수도 있다. 또한 역핧을 바꿔가며 서비스를 사용할 수도 있다.

![스크린샷 2023-07-04 오후 10.24.35.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9644f594-6f1e-4791-b56f-4bd3ff30b7bd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-04_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.24.35.png)

## IAM 의 권한 검증 과정

ex) 사용자가 S3 를 사용하고자 하는 경우

1. 사용자에게 S3 를 이용할 수 있는 `정책` 이 부여되어 있는가?

부여되어 있다면 → S3 접근 가능

1. 내가 속한 그룹에 S3 를 이용할 수 있는 `정책` 이 부여되어 있는가?

부여되어 있다면 → S3 접근 가능

1. 내가 위임된 `역할` 에 S3 를 이용할 수 있는 `정책` 이 부여되어 있는가?

부여되어 있다면 → S3 접근 가능

1, 2, 3 중 어느 한 가지에라도 해당되는 사항이 없다면 해당 사용자는 S3 에 대한 권한이 없는 것으로 확인

ex) AWS 의 어느 서비스에서 S3 서비스를 이용하고자 하는 경우

해당 서비스가 부여 받은 역할이 S3 를 이용할 수 있는 `정책` 이 부여되어 있는가?

부여되어 있다면 → S3 접근 가능하고, 아닐 경우 권한이 없는 것으로 확인

IAM 계정에는 기본적으로 billing  에 대한 권한이 없다. 따라서 Root 계정에 접속해서 오른쪽 상단의 계정 페이지에 접속한 뒤 스크롤을 쭉 내리면 아래와 같은 메뉴가 존재한다. 해당 메뉴를 `비활성화`에서 `활성화`로 바꾸어주면 IAM 계정에서도 billing 에 접근이 가능해진다.

![스크린샷 2023-07-04 오후 10.37.35.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d7513ad4-f950-4bad-8070-87f4cb0101c4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-04_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.37.35.png)

![스크린샷 2023-07-04 오후 10.37.35.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d7513ad4-f950-4bad-8070-87f4cb0101c4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-04_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.37.35.png)

IAM 자격 증명 보고서 

계정의 모든 사용자와 암호, 엑세스 키, MFA 장치 등의 증명 상태를 나열하는 보고서를 생성하고 다운로드가 가능하다. 4시간에 한 번씩 생성 가능하다.

## IAM 을 효율적으로 사용하기

- 루트 계정은 사용 ❌
- 불필요한 사용자 개설❌
- 가능하면 그룹과 정책을 사용
- 최소한의 권한만을 허용하기
- MFA 를 활성화
- access key 대신 역할을 활용하기
- IAM 자격 증명 보고서 활용